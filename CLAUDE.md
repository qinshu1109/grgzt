
- **本地工作流（Claude Code 视角）**
1) 从 Issue 进入实现（示例：`/pm:issue-start <ID>` 启动专用代理工作流）
2) 仅在该 Issue 的**Scope**内读写文件；跨域修改先提建议等待新 Issue。
3) 周期性同步进展（纪要、决策、剩余风险）：`/pm:issue-sync <ID>`
4) 完成后提交 PR，PR 描述**链接 Issue**并勾选验收项。
5) 若被阻塞，标注原因并用 `/pm:blocked` 更新状态。

## 红线规则（禁止自动执行完整流程）
- **禁止自动一条龙**：所有 `/pm:*` 或 `/issue:*` 命令**禁止**自动执行完整流程
- **步骤间强制交互**：每个步骤完成后必须**询问确认**才能进入下一步
- **用户意图确认**：每个步骤开始前需**充份理解用户意图**，确保与用户期望一致
- **暂停等待指令**：完成当前步骤后**暂停并等待**用户下一步指令，不擅自继续
- **个人使用场景**：所有 `/` 命令引用模板资源或工作流文件的执行都必须围绕个人使用场景
- **禁止自动生成企业需求**：严格禁止在不理解用户意图和需求的情况下自动生成企业级、工作化、复杂化的需求（绝对红线）
- **文件映射**：任务初期用 `001.md/002.md`，同步后重命名为 `{issue-id}.md`，便于“issue #1234 ↔ 文件 1234.md”一一对应。  

---

## 9. Claude Code 行为准则（给 AI/代理）
- **读取→计划→最小修改**：  
1) 列出将读取/修改的文件；2) 给出最小变更计划；3) 逐步实施；4) 记录要点。  
- **边界守卫**：禁止跨越「模块边界/目录约束/依赖黑名单」。若实现需要跨域：只提交建议与影响评估。  
- **输出格式**：优先提交**可运行代码 + 必要注释/测试**；避免长篇解释，变更理由简要写入 Issue/PR 注释。  
- **工具与权限**：需要 shell/git/编辑等高权限操作时，先说明意图与预期文件差异；保持最小权限原则。  
- **缺失信息处理**：遇到需求不清或隐含约束，**提出澄清问题**或补充假设，并在 Issue 里记录。  

---

## 10. 语言/栈专属规范（示例：TypeScript）
- 严格类型（`noImplicitAny`），禁止 `any`/`!` 除非在边界层并注释理由。  
- 公共 API 用 Zod/TypeBox 定义并复用；HTTP 层做输入校验与错误映射。  
- Side-effect 受控；IO 统一在 `infrastructure` 层；领域逻辑放 `domain`。  

---

## 11. 提交流程与版本
- 分支：`feat/<scope>-<issue-id>`、`fix/<scope>-<issue-id>`。  
- 提交信息约定式（type(scope): subject #id）。  
- 变更日志自动生成；语义化版本或按服务独立版本。

---

## 12. 附录：常用命令备忘（CCPM）
- 初始化与准备：`/pm:init` → `/init include rules from .claude/CLAUDE.md` → `/context:create`  
- PRD→Epic→任务：`/pm:prd-new` → `/pm:prd-parse` → `/pm:epic-decompose` → `/pm:epic-oneshot`  
- 执行与同步：`/pm:issue-start <ID>`、`/pm:issue-sync <ID>`、`/pm:next`、`/pm:status`

