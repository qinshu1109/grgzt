# [P1.1] PRD历史与证据查看

id: 28
title: PRD历史保存与证据片段查看（P0将JSON存prds.extracted_json）
priority: P1
estimate: 3番茄 (4小时)
status: todo
depends_on: [24]
parallel_with: [18]
module: history
ext_id:

## 目的/产出
实现PRD历史记录保存功能，支持证据片段查看和历史数据复用。

## 实施步骤

1. prds表结构创建
   - 创建prds表存储PRD历史
   - 字段：id、title、raw_text、created_at、parse_method、extracted_json、confidence
   - 实现SQLite/IndexedDB双后端支持

2. PRD保存逻辑
   - 在识别完成后自动保存PRD和识别结果
   - extracted_json存储完整的识别结果和证据片段
   - 生成唯一标识和时间戳

3. 历史记录界面
   - PRD历史列表显示（标题、日期、置信度）
   - 搜索和筛选功能
   - 历史记录的删除和清理

4. 证据片段查看功能
   - 从extracted_json中解析证据片段
   - 在识别结果表格中显示"查看证据"链接
   - 弹出或侧边栏显示原始文本片段

5. 历史数据复用
   - 从历史记录复制配置参数
   - 复用识别结果作为起点
   - 支持历史版本的对比

## 验收标准

- ✅ prds表创建成功，数据保存完整
- ✅ 历史记录列表显示正确，支持搜索
- ✅ 证据片段查看功能正常工作
- ✅ 历史数据可以正常复用
- ✅ 数据存储空间管理合理
- ✅ 与现有识别功能兼容

## 约束/边界

**仅修改以下文件/模块**：
- main.js (历史记录保存和读取逻辑)
- index.html (历史记录界面组件)
- 相关的数据库操作

**明确不修改**：
- 现有识别算法和逻辑
- 其他业务功能
- 用户界面主要结构

## 依赖/并行

- **依赖**: 24(规则引擎，产生识别结果)
- **可并行**: 18(不确定性清单)

## 风险与回退

**可能风险**：
- extracted_json数据结构复杂
- 历史数据存储空间过大
- 性能问题影响用户体验

**回退方式**：
- 简化JSON数据结构
- 添加数据清理机制
- 实现分页和懒加载
